<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta name="keywords" content="自宅サーバ 停電対策">
<meta name="Author" content="Takafumi Shido">
<meta name="robots" content="all">
<link rel="stylesheet" href="/shido.css" text="text/css">
<link rel="icon" href="/images/shido.png" type="image/png">
<title> 停電が起きたときに自動で自宅サーバーをシャットダウンする方法 </title>
</head>
<body>
<p class="header">
<table class='guide'><tr>
  <td><a rel=home href='/index.html'>

  <img src='/images/shido_small.png' class='arrow' border=0>HOME</a></td>
<td><a rel=up href="/misc/index.html"><img src='/images/up_arrow.gif' class='arrow' border=0>備忘録</a></td>
<td><a rel=up href="/gb/write_guestbook.php?ref=misc41&t=%C4%E4%C5%C5%A4%AC%B5%AF%A4%AD%A4%BF%A4%C8%A4%AD%A4%CB%BC%AB%C6%B0%A4%C7%BC%AB%C2%F0%A5%B5%A1%BC%A5%D0%A1%BC%A4%F2%A5%B7%A5%E3%A5%C3%A5%C8%A5%C0%A5%A6%A5%F3%A4%B9%A4%EB%CA%FD%CB%A1"><img src='/images/pencil.gif' class='arrow' border=0>書き込む</a></td>
</tr></table></p>

<h1>停電が起きたときに自動で自宅サーバーをシャットダウンする方法</h1>
<hr>
Mar 15, 2011
<p>

東北の大地震に伴い、東電が計画停電を実施しています。
そのため、我が家の自宅サーバーはかなり稼働率が悪くなっています。<br>
しかし、実は、我が家は一度も停電しておらず、無駄にサーバーをシャットダウンさせていました。<br>
そこで、実際に停電が起きたときだけ、サーバーをシャットダウンさせるようにしました。<p>

我が家のサーバーは UPS から電源を取っているので、停電が起きても数分は持ちます。<br>
一方、ルーターは停電が起きるとすぐに停止するので、ルーターが生きているかをみて、死んでいたら
サーバーをシャットダウンするようにしました。
具体的には、<tt>/etc/crontab</tt> に以下の行を追加して、毎分ルータに ping し、応答がなければ
シャットダウンするようにしました。

<pre class='code'>
* *  * * *     root    ping -c 1 192.168.1.1 &gt; /dev/null || shutdown -h now
</pre>

<tt>192.168.1.1</tt> は我が家のルータの IP address です。
<p>
これで、無駄にサーバーを落とすことがなくなりました。


<hr>
<p class="footer">
<table class='guide'><tr>
  <td><a rel=home href='/index.html'>
  <img src='/images/shido_small.png' class='arrow' border=0>HOME</a></td>
<td><a rel=up href="/misc/index.html"><img src='/images/up_arrow.gif' class='arrow' border=0>備忘録</a></td>
<td><a rel=up href="/gb/write_guestbook.php?ref=misc41&t=%C4%E4%C5%C5%A4%AC%B5%AF%A4%AD%A4%BF%A4%C8%A4%AD%A4%CB%BC%AB%C6%B0%A4%C7%BC%AB%C2%F0%A5%B5%A1%BC%A5%D0%A1%BC%A4%F2%A5%B7%A5%E3%A5%C3%A5%C8%A5%C0%A5%A6%A5%F3%A4%B9%A4%EB%CA%FD%CB%A1"><img src='/images/pencil.gif' class='arrow' border=0>書き込む</a></td>
</tr></table></p>
</body>
</html>
